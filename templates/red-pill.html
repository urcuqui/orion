<!DOCTYPE html>
<html lang="en">
<head>    
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI CyberSec Project</title>    
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <style>
    body {
      background-color: black;
      color: #00ff00;
      font-family: "Courier New", monospace;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      height: 100vh;
      margin: 0;
      text-align: center;
    }
    h1 {
      margin: 20px 0 10px;
    }
    .container {
      display: flex;
      width: 100%;
      height: 60vh;
      margin-top: 10px;
    }
    .left-panel, .right-panel {
      flex: 1;
      padding: 10px;
      border: 1px solid #00ff00;
      overflow: auto;
    }
    /* 1) convierte la izquierda en posicion relativa */
    .left-panel {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    overflow: visible;
  }
   #chat-box {
    position: relative;
    background-color: black;
    border: 1px solid #00ff00;
    border-radius: 12px;
    padding: 12px;
    width: 79%;
    height: 300px;
    overflow-y: auto;
     /* Firefox */
    scrollbar-width: none;
    /* IE 10+ */
    -ms-overflow-style: none;
  }
    #chat-box::after {
    content: "";
    position: absolute;
    bottom: -14px;
    right: 60px;
    border-width: 14px 10px 0 10px;
    border-style: solid;
    border-color: black transparent transparent transparent;
  }
    /* 2) estilo del GIF */
      .pet-gif {
        position: absolute;
        bottom: 10px;
        right: 10px;
        width: 80px;
        pointer-events: none;
    }
    .loading {
      color: #00ff00;
      font-style: italic;
      animation: blink 1s infinite;
    }
    @keyframes blink {
      0%   { opacity: 1; }
      50%  { opacity: 0; }
      100% { opacity: 1; }
    }
    input, button {
      background: black;
      color: #00ff00;
      border: 1px solid #00ff00;
      padding: 5px;
      font-family: "Courier New", monospace;
    }
    button {
      cursor: pointer;
    }
    button:hover {
      background-color: rgba(0, 255, 0, 0.2);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      color: #00ff00;
    }
    th, td {
      border: 1px solid #00ff00;
      padding: 5px;
      text-align: left;
    }
    #ascii-container {
      position: absolute;
      bottom: 20px;
      left: 10px;
      text-align: left;
    }
    /* WebKit browsers (Chrome, Safari, Edge) */
    #chat-box::-webkit-scrollbar {
    width: 0;
    height: 0;
    }
  </style>
</head>
<body>
  <h1>ORION Phishing Creator</h1>
  <div class="container">
    <div class="left-panel">
      <div id="chat-box"></div>
      
      <!-- Tu input y botón -->
      
      <button onclick="sendMessage()">Create</button>
      
      <!-- 3) inserta aquí tu GIF -->
      <img src="../static/lip.gif" alt="Mascota interactiva" class="pet-gif">
    </div>
    
    <div class="right-panel">
      <h2>Chat History</h2>
      <div id="chat-history"></div>
    </div>
  </div>
  
  <div id="ascii-container">
    <pre>
 ___   ___    __   ____  ___    ___    __    __    
|   | /  |   |  |  |  |  |  |  /  |   |  |  |  |       [0][1][0]  
|   |/  /    |  |  |  |  |  | /  /    |  |  |  |       [0][0][1]   
|      /     |  |  |  |  |      |      \  \_/  /       [1][1][1]
|  |\  \     |  '--'  |  |  |\  \        \   /        
| _| `.__\   |________|  | _| `.__\      |___| 
    </pre>
  </div>

  <script>
    async function sendMessage() {
      
      let chatBox = document.getElementById('chat-box');
      
      let loadingMessage = document.createElement('p');
      loadingMessage.className = 'loading';
      loadingMessage.innerText = 'Orion is thinking...';
      chatBox.appendChild(loadingMessage);

      try {
        let response = await fetch('/chat_phishing', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ message: "" })
        });

        if (response.ok) {
          let data = await response.json();
          loadingMessage.remove();
          let markdownResponse = marked.parse(data.response);
          chatBox.innerHTML += `<p><strong>Orion:</strong></p><div>${markdownResponse}</div>`;
        } else {
          loadingMessage.remove();
          chatBox.innerHTML += `<p><strong>Orion:</strong> Error: Unable to process your request.</p>`;
        }
      } catch (error) {
        loadingMessage.remove();
        chatBox.innerHTML += `<p><strong>Orion:</strong> Error: ${error.message}</p>`;
      }
    }
  </script>
</body>
</html>
